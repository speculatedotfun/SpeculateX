specVersion: 0.0.5
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum/contract
    name: SpeculateCore
    network: bsc
    source:
      address: "0xfBd5dD6bC095eA9C3187AEC24E4D1F04F25f8365"
      abi: SpeculateCore
      startBlock: 73821951   # Deployed January 2, 2026 (With createScheduledMarket + 24h timelock)
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - Market
        - Trade
        - PositionBalance
        - Redemption
        - User
        - GlobalState
        - LpResidualClaim
        - ResidualFinalization
      abis:
        - name: SpeculateCore
          file: ./abis/SpeculateCore.json
      eventHandlers:
        - event: MarketCreated(indexed uint256,address,address,bytes32,string,uint256,uint256)
          handler: handleMarketCreated
        - event: ScheduledMarketCreated(indexed uint256,address,address,bytes32,string,uint256,uint256,uint256)
          handler: handleScheduledMarketCreated
        - event: Buy(indexed uint256,indexed address,bool,uint256,uint256,uint256)
          handler: handleBuy
        - event: Sell(indexed uint256,indexed address,bool,uint256,uint256,uint256)
          handler: handleSell
        - event: Redeemed(indexed uint256,indexed address,uint256)
          handler: handleRedeemed
        - event: MarketResolved(indexed uint256,bool)
          handler: handleMarketResolved
        - event: MarketCancelled(indexed uint256)
          handler: handleMarketCancelled
        - event: LpResidualClaimed(indexed uint256,indexed address,uint256)
          handler: handleLpResidualClaimed
        - event: ResidualFinalized(indexed uint256,uint256,uint256)
          handler: handleResidualFinalized
      file: ./src/mapping.ts

